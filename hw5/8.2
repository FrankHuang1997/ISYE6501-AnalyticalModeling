data1=read.table('C:\\Users\\huangchengqi\\Desktop\\MS SCE\\19Fall\\ISYE6501\\hw5\\data 8.2\\uscrime.txt',header=TRUE)

#use the whole data set to do linear regression.
model1 <- lm(Crime~., data1)
test_data_set <-data.frame(M = 14,So = 0, Ed = 10.0, Po1 = 12.0, Po2 = 15.5,LF = 0.64, M.F = 94.0, Pop = 150, NW = 1.1, U1 = 0.12, U2 = 3.6, Wealth = 3200, Ineq = 20.1, Prob = 0.040, Time = 39.0)
pred <- predict(model1, test_data_set)
summary(model1)

#First we check the value of vif to see if some predictors are correlated. 
library(car)
vif(model1)
cor(data1[,4],data1[,5])
plot(x=data1[,4],y=data1[,5])
#po1 and po2 are strongly correlated.
data1[,17] <- (data1[,4]+data1[,5])/2
model2 <- lm( Crime ~  M + So + Ed + M.F + Pop + NW + U1 + U2+ Wealth + Ineq + Prob + Time + V17, data = data1)
test_data_set2 <-data.frame(M = 14,So = 0, Ed = 10.0,LF = 0.64, M.F = 94.0, Pop = 150,  NW = 1.1, U1 = 0.12, U2 = 3.6, Wealth = 3200, Ineq = 20.1, Prob = 0.040, Time = 39.0, V17=18.75 )
pred2<- predict(model2, test_data_set2)
summary(model2)
vif(model2)
#the correlation issue seems ok.
#we should then look at the p value and identify irrelavent attribute
#looks So, pop, NW, wealth are irrelavant because the P value is so large. 
model3 <- lm( Crime ~  M + Ed + M.F + U1 + U2 + Ineq + Prob + V17, data = data1)
test_data_set3 <-data.frame(M = 14, Ed = 10.0, M.F = 94.0, U1 = 0.12, U2 = 3.6, Ineq = 20.1, Prob = 0.040, V17=18.75)
pred3 <- predict(model3, test_data_set3)
summary(model3)
pred3
#that looks like a reasonable prediction. 
#still need to check qqplot and AICc
plot(model3)
AIC(model3)


